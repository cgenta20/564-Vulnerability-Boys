
Setup Remote C2 Command:
msfrpcd -f -a 192.168.56.1 -p 55553 -U admin -P hehehe

On my vm:
msfrpcd -f -a 192.168.56.3 -p 55553 -U admin -P hehehe


Ngrok Functionality:
ngrok start --all

ngrok config.yml:
"""
version: "2"
authtoken: <your auth-token>
tunnels:
  first:
    addr: 192.168.56.3:55553
    proto: tcp    
  second:
    addr: 192.168.56.3:8443
    proto: tcp
"""

The first tunnel for our C2 Communication Channel and the second for implant Communication channel

Resources:
https://docs.metasploit.com/api/Msf/RPC.html
https://docs.metasploit.com/docs/using-metasploit/advanced/RPC/how-to-use-metasploit-messagepack-rpc.html
https://docs.rapid7.com/metasploit/rpc-api

https://pypi.org/project/pymetasploit3/
https://github.com/allfro/pymetasploit



For me did not work:
#load msgrpc ServerHost=192.168.56.1 ServerPort=55553 User=admin Pass=hehehe

#load msgrpc ServerHost=192.168.56.1 ServerPort=55553 Username=admin Password=hehehe

#load msgrpc ServerHost=192.168.56.3 ServerPort=55553 Username=admin Password=hehehe